var q=Object.defineProperty;var x=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var E=(e,t,o)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,L=(e,t)=>{for(var o in t||(t={}))z.call(t,o)&&E(e,o,t[o]);if(x)for(var o of x(t))P.call(t,o)&&E(e,o,t[o]);return e};var k=(e,t,o)=>new Promise((d,a)=>{var y=n=>{try{h(o.next(n))}catch(u){a(u)}},c=n=>{try{h(o.throw(n))}catch(u){a(u)}},h=n=>n.done?d(n.value):Promise.resolve(n.value).then(y,c);h((o=o.apply(e,t)).next())});import{F as U}from"./Footer.79c86c97.js";import{L as M}from"./ListComponent.851f6679.js";import{T as V,L as O,a as R,u as I,b as K}from"./tenants.31cefe32.js";import{h as F,D as T,_ as S,i as l,j as f,k as s,r as i,m as p,E as m,G as w,l as b,t as _,q as j,s as $,F as G,n as J,H as Q,f as W,I as X,J as Y,B as Z,K as ee}from"./vendor.fddf21c1.js";import{e as te,M as se}from"./Button.f813293b.js";const oe=F({name:"Checkbox",props:{selected:{type:Boolean,default:()=>!1,required:!0}},setup(){return{checkbox:T()}},methods:{changeSelection(){this.$emit("checkChanged",this.checkbox.checked)}},emits:{checkChanged:()=>!0}}),ne={class:"grid items-center"},ae=["value","checked"];function le(e,t,o,d,a,y){return l(),f("div",ne,[s("input",{ref:"checkbox",type:"checkbox",value:e.selected,checked:e.selected,onClick:t[0]||(t[0]=(...c)=>e.changeSelection&&e.changeSelection(...c)),class:"h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"},null,8,ae)])}var re=S(oe,[["render",le]]);const ie=F({name:"TenantList",components:{TenantSearchBar:V,ListComponent:M,Checkbox:re,Badge:te,LinkButton:O},props:{showEditButton:{type:Boolean,default:()=>!1},showActions:{type:Boolean,default:()=>!1},selectable:{type:Boolean,default:()=>!1},filter:{type:String,default:()=>""},tenant:{type:Object,required:!0},tags:{type:Object,required:!1},showTags:{type:Boolean,required:!1}},emits:{loadMore:()=>!0,showDialog:()=>!0,selectedFilterChanged:()=>!0},mounted(){return k(this,null,function*(){yield this.tenant.fetch()})},methods:{executeSearch(e){this.tenant.search(e,this.filter)},getMobileHref(e){return`tel:${e}`},getMailHref(e){return`mailto:${e}`},showDialog(e){this.showEditButton&&this.$emit("showDialog",e)},checkChanged(e,t){t?this.tenant.select(e):this.tenant.unselect(e)},getUserTags(e){return e?e.split(",").filter(t=>t!==""):[]}}}),de={class:"overflow-y-scroll"},ce={class:"flex p-4"},he={class:"grid grid-cols-2 content-center"},ue=s("svg",{class:"w-10 h-10 text-gray-200","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[s("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z","clip-rule":"evenodd"})],-1),ge={class:"grow p-2"},fe={class:"font-semibold"},pe={class:"font-semibold"},me={key:0,class:"grid grid-cols-1 sm:grid-cols-3 gap-4 content-center"},be=["href"],_e=s("i",{class:"fa fa-phone","aria-hidden":"true"},null,-1),ye=s("span",{class:"sr-only"},"Phonecall",-1),we=[_e,ye],ve=["href"],Ce=s("i",{class:"fa fa-envelope","aria-hidden":"true"},null,-1),ke=s("span",{class:"sr-only"},"EMail",-1),Te=[Ce,ke],$e=["onClick"],Be=s("i",{class:"fa fa-edit","aria-hidden":"true"},null,-1),Fe=s("span",{class:"sr-only"},"Edit",-1),Se=[Be,Fe],De={class:"p-4"},xe={class:"flex"},Ee=s("div",{class:"grow"},null,-1),Le=["href"];function Me(e,t,o,d,a,y){var g;const c=i("TenantSearchBar"),h=i("Checkbox"),n=i("Badge"),u=i("ListComponent");return l(),f("div",null,[s("div",null,[p(c,{onSearch:e.executeSearch,onSelectedFilterChanged:t[0]||(t[0]=r=>this.$emit("selectedFilterChanged",r)),showFilters:e.showTags,filters:(g=e.tags)!=null?g:[],class:"mb-4"},null,8,["onSearch","showFilters","filters"])]),s("div",de,[p(u,{onLoadMore:e.tenant.loadMore,items:e.tenant.tenants,checkable:!1,headerList:["P\xE4chter"],hasNext:e.tenant.pageInfo.hasNext,onShowDetails:t[1]||(t[1]=r=>this.showDialog(r.name))},{item:m(({name:r,plot_link:N,email_id:D,mobile_no:v,customer_group:B,selected:A,_user_tags:H})=>[s("div",ce,[s("div",he,[e.selectable?(l(),w(h,{key:0,selected:A,onCheckChanged:C=>this.checkChanged(r,C)},null,8,["selected","onCheckChanged"])):b("",!0),ue]),s("div",ge,[s("div",fe,_(r),1),s("div",pe,_(N),1),s("div",null,_(D),1),s("div",null,_(v),1)]),e.showActions?(l(),f("div",me,[s("a",{href:e.getMobileHref(v),type:"button",class:j([v?"text-blue-700 hover:bg-blue-700 border border-blue-700  hover:text-white focus:ring-4 focus:outline-none focus:ring-blue-300 ":"border border-gray-300  bg-gray-100","disabled:opacity-75 font-medium rounded-full text-sm p-2.5 text-center inline-flex items-center"])},we,10,be),s("a",{href:e.getMailHref(D),type:"button",class:j([v?"text-blue-700 hover:bg-blue-700 border border-blue-700  hover:text-white focus:ring-4 focus:outline-none focus:ring-blue-300 ":"border border-gray-300  bg-gray-100","disabled:opacity-75 font-medium rounded-full text-sm p-2.5 text-center inline-flex items-center"])},Te,10,ve),e.showEditButton?(l(),f("button",{key:0,type:"button",onClick:C=>this.showDialog(r),class:"text-blue-700 border border-blue-700 hover:bg-blue-700 hover:text-white focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-full text-sm p-2.5 text-center inline-flex items-center"},Se,8,$e)):b("",!0)])):b("",!0)]),s("div",De,[s("div",xe,[B==="Tenant"?(l(),w(n,{key:0,type:"green"},{default:m(()=>[$("P\xE4chter")]),_:1})):b("",!0),B==="Former Tenant"?(l(),w(n,{key:1,type:"yellow"},{default:m(()=>[$("Ehemaliger P\xE4chter")]),_:1})):b("",!0),B==="Member"?(l(),w(n,{key:2,type:"dark"},{default:m(()=>[$("Passives Mitglied")]),_:1})):b("",!0),(l(!0),f(G,null,J(e.getUserTags(H),(C,ze)=>(l(),w(n,null,{default:m(()=>[$(_(C),1)]),_:2},1024))),256)),Ee,s("div",null,[s("a",{class:"pl-4 font-medium text-blue-600 hover:underline",target:"_blank",href:`/app/customer/${r}`},_(e.$t("tenant_list.open_in_desk")),9,Le)])])])]),_:1},8,["onLoadMore","items","hasNext"])])])}var Ve=S(ie,[["render",Me]]);function je(e){const t=Q([]),o=W({url:e.url});return{fetch:()=>k(this,null,function*(){try{t.splice(0,t.length),yield o.fetch(),t.push(...o.data.map(a=>L({},a)))}catch(a){console.error(a)}}),items:t}}const Ne=F({name:"paechter",components:{FooterComponent:U,Dropdown:X,Alert:Y,Button:Z,ListComponent:M,Dialog:ee,TenantEditor:R,TenantSearchBar:V,TenantList:Ve,Select:se},methods:{showDialog(e){this.selectedCustomer=e,this.bodyDialog=!0},closeEditor(){this.bodyDialog=!1},selectedTagChanged(e){this.selectedTag=e,this.tenant.search(e,this.selectedFilter)}},setup(){const e=I(),t=K(),o=T("");T("");const d=je({url:"/api/method/erpnext_kleingartenverein.api.get_tenant_tags"}),a=T("");return{selectedCustomer:o,editor:t,tenant:e,filters:[{value:"",name:"Kein Filter"},{value:"withTag",name:"Hat Schlagwort"},{value:"withoutTag",name:"Ohne Schlagwort"}],selectedFilter:a,tags:d}},mounted(){return k(this,null,function*(){yield this.tags.fetch()})},watch:{selectedFilter:function(e){this.selectedFilter!==""?this.tenant.search(this.selectedTag,this.selectedFilter):this.tenant.clear()}},data(){return{bodyDialog:!1}}}),Ae={class:"p-4 sm:ml-64"},He={class:"ml-2 mr-2 mb-4"};function qe(e,t,o,d,a,y){const c=i("TenantEditor"),h=i("Dialog"),n=i("Select"),u=i("TenantList");return l(),f("div",Ae,[p(h,{id:"tenant-dialog",modelValue:e.bodyDialog,"onUpdate:modelValue":t[0]||(t[0]=g=>e.bodyDialog=g),style:{"z-index":"300"}},{body:m(()=>[p(c,{class:"tenant-editor",item:e.selectedCustomer,onClose:e.closeEditor},null,8,["item","onClose"])]),_:1},8,["modelValue"]),s("div",He,[p(n,{modelValue:e.selectedFilter,"onUpdate:modelValue":t[1]||(t[1]=g=>e.selectedFilter=g),placeholder:e.$t("tenant_list.select_placeholder"),options:e.filters,class:"rounded-lg border border-gray-300"},null,8,["modelValue","placeholder","options"])]),p(u,{onSelectedFilterChanged:e.selectedTagChanged,onShowDialog:e.showDialog,tags:e.tags.items,showTags:e.selectedFilter!=="",filter:e.selectedFilter,tenant:e.tenant,showEditButton:!0,showActions:!0},null,8,["onSelectedFilterChanged","onShowDialog","tags","showTags","filter","tenant"])])}var Ge=S(Ne,[["render",qe]]);export{Ge as default};
